# Marchine Learning

## 1. k-NN regression

```python
import numpy as np
import matplotlib.pyplot as plt

# create data
np.random.seed(20)
x = np.random.uniform(0, 10, 18)
y = np.random.uniform(0, 10, 18)

# create scatter plot
plt.figure(figsize=(8, 6))
plt.scatter(x, y, c='blue', label='$Random\; Points$')
plt.title('$Scatter\; Plot\; with\; 18\; Random\; Points$')
plt.xlabel('$X$')
plt.ylabel('$Y$')
plt.legend()
plt.show()
```
![scatter](https://github.com/weinter0101/python-practice/blob/main/machine%20learning/graph/graph1.1.png)

- k=1
### k=2
```python
<div style="height: 300px; overflow: auto;">
    <pre><code>
    # 这是一个 Python 代码块示例
    import numpy as np
import matplotlib.pyplot as plt

# create data
np.random.seed(20)
x = np.random.uniform(0, 10, 18)
y = np.random.uniform(0, 10, 18)

# create scatter plot
plt.figure(figsize=(8, 6))
plt.scatter(x, y, c='blue', label='$Random\; Points$')
plt.title('$Scatter\; Plot\; with\; 18\; Random\; Points$')
plt.xlabel('$X$')
plt.ylabel('$Y$')
plt.legend()
plt.show()

# k=1
from sklearn.neighbors import KNeighborsRegressor

# Function to perform k-NN regression and plot in a 2x2 grid of subplots
def knn_regression_and_plot_grid(x, y, k_values):
    # Create figure and axes
    fig, axs = plt.subplots(2, 2, figsize=(15, 10))
    axs = axs.flatten()  # Flatten the 2x2 grid into a 1D array for easier access
    # Generating sample points for making predictions and plotting
    T = np.linspace(0, 10, 500)[:, np.newaxis]
    for i, k in enumerate(k_values):
        # Create and fit the model
        knn = KNeighborsRegressor(n_neighbors=k)
        knn.fit(x.reshape(-1, 1), y)
        # Predictions for the sample points
        y_ = knn.predict(T)
        # Plotting
        axs[i].scatter(x, y, color='black', label='Data Points')
        axs[i].plot(T, y_, color='red', label=f'k={k} Regression')
        axs[i].set_title(f'k-NN Regression with k={k}')
        axs[i].set_xlabel('X')
        axs[i].legend()
    # Adjust layout
    plt.tight_layout()
    plt.show()
# Define k values for the 2x2 grid
k_values_grid = [1, 2, 5, 18]
# Perform k-NN regression and plot in a 2x2 grid of subplots
knn_regression_and_plot_grid(x, y, k_values_grid)
    </code></pre>
</div>
